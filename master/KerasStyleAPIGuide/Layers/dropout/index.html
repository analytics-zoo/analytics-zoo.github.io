<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Dropout Layers - Analytics Zoo</title>
    <link href="/css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="/css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="/css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/highlight.css">
    <link href="../../../extra.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/bootstrap-3.3.7.min.js"></script>
    <script src="/js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Dropout", url: "#dropout", children: [
          ]},
          {title: "SpatialDropout2D", url: "#spatialdropout2d", children: [
          ]},
        ];

    </script>
    <script src="/js/base.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-125166209-1', 'analytics-zoo.github.io');
        ga('send', 'pageview');
    </script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    
    <h1><strong>Dropout Layers</strong></h1>
    <hr>
    <h2 id="dropout"><strong>Dropout</strong></h2>
<p>Applies Dropout to the input by randomly setting a fraction 'p' of input units to 0 at each update during training time in order to prevent overfitting.</p>
<p><strong>Scala:</strong></p>
<pre><code class="scala">Dropout(p, inputShape = null)
</code></pre>

<p><strong>Python:</strong></p>
<pre><code class="python">Dropout(p, input_shape=None, name=None)
</code></pre>

<p><strong>Parameters:</strong></p>
<ul>
<li><code>p</code>: Fraction of the input units to drop. Between 0 and 1.</li>
<li><code>inputShape</code>: Only need to specify this argument when you use this layer as the first layer of a model. For Scala API, it should be a <a href="../../keras-api-scala/#shape"><code>Shape</code></a> object. For Python API, it should be a shape tuple. Batch dimension should be excluded.</li>
</ul>
<p><strong>Scala example:</strong></p>
<pre><code class="scala">import com.intel.analytics.zoo.pipeline.api.keras.models.Sequential
import com.intel.analytics.zoo.pipeline.api.keras.layers.Dropout
import com.intel.analytics.bigdl.utils.Shape
import com.intel.analytics.bigdl.tensor.Tensor

val model = Sequential[Float]()
model.add(Dropout[Float](0.3, inputShape = Shape(3, 4)))
val input = Tensor[Float](2, 3, 4).randn()
val output = model.forward(input)
</code></pre>

<p>Input is:</p>
<pre><code class="scala">input: com.intel.analytics.bigdl.tensor.Tensor[Float] =
(1,.,.) =
1.5496527       0.34846303      1.8184849       -0.8750735
-0.2907603      0.124056354     -0.5447822      -0.34512782
1.003834        -0.27847317     -0.16524693     -0.12172801

(2,.,.) =
-0.50297844     -0.78188837     -1.5617784      -1.2353797
-1.5052266      -1.6246556      0.5203618       1.144502
-0.18044183     -0.032648038    -1.9599762      -0.6970337

[com.intel.analytics.bigdl.tensor.DenseTensor of size 2x3x4]
</code></pre>

<p>Output is:</p>
<pre><code class="scala">output: com.intel.analytics.bigdl.nn.abstractnn.Activity =
(1,.,.) =
2.2137897       0.49780434      2.5978355       -1.250105
0.0     0.17722337      0.0     0.0
1.4340487       0.0     0.0     -0.17389716

(2,.,.) =
-0.71854067     -1.1169834      -2.231112       -1.7648282
-2.1503239      -2.3209367      0.743374        1.635003
-0.25777406     0.0     -2.799966       -0.99576247

[com.intel.analytics.bigdl.tensor.DenseTensor of size 2x3x4]
</code></pre>

<p><strong>Python example:</strong></p>
<pre><code class="python">import numpy as np
from zoo.pipeline.api.keras.layers import Dropout
from zoo.pipeline.api.keras.models import Sequential

model = Sequential()
model.add(Dropout(0.3, input_shape=(3, 4)))
input = np.random.random([2, 3, 4])
output = model.forward(input)
</code></pre>

<p>Input is:</p>
<pre><code class="python">array([[[0.80667346, 0.5370812 , 0.59039134, 0.48676815],
        [0.70987046, 0.11246564, 0.68062359, 0.48074257],
        [0.61979472, 0.36682032, 0.08320745, 0.41117697]],

       [[0.19616717, 0.18093539, 0.52080897, 0.73326568],
        [0.72752776, 0.81963229, 0.05652756, 0.37253947],
        [0.70200807, 0.27836313, 0.24421078, 0.58191582]]])
</code></pre>

<p>Output is</p>
<pre><code class="python">array([[[1.1523907 , 0.7672588 , 0.        , 0.6953831 ],
        [1.0141007 , 0.1606652 , 0.9723194 , 0.6867751 ],
        [0.        , 0.5240291 , 0.11886779, 0.58739567]],

       [[0.2802388 , 0.        , 0.74401283, 1.0475224 ],
        [1.0393254 , 1.1709033 , 0.08075366, 0.53219926],
        [1.0028687 , 0.39766163, 0.        , 0.8313083 ]]], dtype=float32)
</code></pre>

<hr />
<h2 id="spatialdropout2d"><strong>SpatialDropout2D</strong></h2>
<p>Spatial 2D version of Dropout.</p>
<p>This version performs the same function as Dropout, however it drops entire 2D feature maps instead of individual elements. If adjacent pixels within feature maps are strongly correlated (as is normally the case in early convolution layers) then regular dropout will not regularize the activations and will otherwise just result in an effective learning rate decrease. In this case, SpatialDropout2D will help promote independence between feature maps and should be used instead.</p>
<p>The input of this layer should be 4D tensor with shape: (samples, channels, rows, cols) if data_format='th' (Channel First) or 4D tensor with shape: (samples, rows, cols, channels) if data_format='tf' (Channel Last).</p>
<p><strong>Scala:</strong></p>
<pre><code class="scala">SpatialDropout2D(p = 0.5, dimOrdering = &quot;th&quot;, inputShape = null)
</code></pre>

<p><strong>Python:</strong></p>
<pre><code class="python">SpatialDropout2D(p=0.5, dim_ordering=&quot;th&quot;, input_shape=None, name=None)
</code></pre>

<p><strong>Parameters:</strong></p>
<ul>
<li><code>p</code>: Fraction of the input units to drop. Between 0 and 1.</li>
<li><code>dimOrdering</code>: Format of input data. Either 'th' (Channel First) or 'tf' (Channel Last). Default is 'th'.</li>
<li><code>inputShape</code>: Only need to specify this argument when you use this layer as the first layer of a model. For Scala API, it should be a <a href="../../keras-api-scala/#shape"><code>Shape</code></a> object. For Python API, it should be a shape tuple. Batch dimension should be excluded.</li>
</ul>
<p><strong>Scala example:</strong></p>
<pre><code class="scala">import com.intel.analytics.zoo.pipeline.api.keras.models.Sequential
import com.intel.analytics.zoo.pipeline.api.keras.layers.SpatialDropout2D
import com.intel.analytics.bigdl.utils.Shape
import com.intel.analytics.bigdl.tensor.Tensor

val model = Sequential[Float]()
model.add(SpatialDropout2D[Float](inputShape = Shape(2, 3, 4)))
val input = Tensor[Float](2, 2, 3, 4).randn()
val output = model.forward(input)
</code></pre>

<p>Input is:</p>
<pre><code class="scala">input: com.intel.analytics.bigdl.tensor.Tensor[Float] =
(1,1,.,.) =
1.266674        -0.19261484     0.8210725       -0.22291088
-0.38138267     1.7019615       1.1729054       0.59097356
-0.50952524     -1.9868233      -0.17180282     -1.2743127

(1,2,.,.) =
-0.13727586     -0.7740464      1.2427979       -0.46285817
-1.747042       1.3353567       1.1310997       -0.26019064
0.9580778       -0.69689065     -0.77704996     0.704949

(2,1,.,.) =
0.040080033     0.08806901      0.44471294      0.4693497
-1.2577269      -2.5343444      -0.5290871      0.73988694
-0.4042877      -0.20460072     -0.68553877     0.59006995

(2,2,.,.) =
-0.06227895     -0.9075216      1.226318        1.0563084
-0.6985987      -0.20155957     0.1005844       -0.49736363
1.3935218       -2.8411357      -1.6742039      0.26154035

[com.intel.analytics.bigdl.tensor.DenseTensor of size 2x2x3x4]
</code></pre>

<p>Output is:</p>
<pre><code class="scala">output: com.intel.analytics.bigdl.nn.abstractnn.Activity =
(1,1,.,.) =
0.0     -0.0    0.0     -0.0
-0.0    0.0     0.0     0.0
-0.0    -0.0    -0.0    -0.0

(1,2,.,.) =
-0.13727586     -0.7740464      1.2427979       -0.46285817
-1.747042       1.3353567       1.1310997       -0.26019064
0.9580778       -0.69689065     -0.77704996     0.704949

(2,1,.,.) =
0.040080033     0.08806901      0.44471294      0.4693497
-1.2577269      -2.5343444      -0.5290871      0.73988694
-0.4042877      -0.20460072     -0.68553877     0.59006995

(2,2,.,.) =
-0.06227895     -0.9075216      1.226318        1.0563084
-0.6985987      -0.20155957     0.1005844       -0.49736363
1.3935218       -2.8411357      -1.6742039      0.26154035

[com.intel.analytics.bigdl.tensor.DenseTensor of size 2x2x3x4]
</code></pre>

<p><strong>Python example:</strong></p>
<pre><code class="python">import numpy as np
from zoo.pipeline.api.keras.models import Sequential
from zoo.pipeline.api.keras.layers import SpatialDropout2D

model = Sequential()
model.add(SpatialDropout2D(input_shape=(2, 3, 4)))
input = np.random.random([2, 2, 3, 4])
output = model.forward(input)
</code></pre>

<p>Input is:</p>
<pre><code class="python">[[[[0.45638721 0.87479404 0.28319946 0.85046252]
   [0.90687581 0.29446766 0.23341603 0.92425726]
   [0.51232495 0.83895807 0.90536451 0.41231943]]

  [[0.00397271 0.28512243 0.32912336 0.27304027]
   [0.97274043 0.92907157 0.25843125 0.201849  ]
   [0.42783297 0.91400856 0.19290376 0.83749261]]]


 [[[0.03282751 0.60866148 0.47616452 0.4300911 ]
   [0.75731354 0.34609462 0.66514783 0.18193801]
   [0.6748754  0.94068849 0.38504096 0.66447561]]

  [[0.61274329 0.56573389 0.21795374 0.45314279]
   [0.2883045  0.22641016 0.83014439 0.21362862]
   [0.33618578 0.47346473 0.96971251 0.2937416 ]]]]
</code></pre>

<p>Output is</p>
<pre><code class="python">[[[[0.45638722 0.87479407 0.28319946 0.8504625 ]
   [0.9068758  0.29446766 0.23341602 0.9242573 ]
   [0.5123249  0.8389581  0.9053645  0.41231942]]

  [[0.00397271 0.28512242 0.32912338 0.27304026]
   [0.9727404  0.92907155 0.25843126 0.201849  ]
   [0.42783296 0.91400856 0.19290376 0.8374926 ]]]


 [[[0.03282751 0.6086615  0.47616452 0.4300911 ]
   [0.75731355 0.3460946  0.66514784 0.18193801]
   [0.6748754  0.9406885  0.38504097 0.6644756 ]]

  [[0.         0.         0.         0.        ]
   [0.         0.         0.         0.        ]
   [0.         0.         0.         0.        ]]]]
</code></pre>

  <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>