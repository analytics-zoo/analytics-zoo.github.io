<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>KerasModel - Analytics Zoo</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="../../../extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-125166209-1', 'analytics-zoo.github.io');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">Analytics Zoo</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../..">Overview</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Releases <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../release-download/">Download</a>
</li>
                                    
<li >
    <a href="../../../release-docs/">Documentation</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">Python</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../PythonUserGuide/install/">Install</a>
</li>
            
<li >
    <a href="../../../PythonUserGuide/run/">Run</a>
</li>
            
<li >
    <a href="../../../PythonUserGuide/examples/">Examples</a>
</li>
            
<li >
    <a href="../../../PythonUserGuide/python-faq/">FAQ</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Scala</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../ScalaUserGuide/install/">Install</a>
</li>
            
<li >
    <a href="../../../ScalaUserGuide/run/">Run</a>
</li>
            
<li >
    <a href="../../../ScalaUserGuide/examples/">Examples</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Programming Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">Pipeline APIs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../ProgrammingGuide/nnframes/">DataFrame and ML Pipeline</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/autograd/">Autograd</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/transferlearning/">Transfer Learning</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/inference/">Model Serving</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">TFPark API</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../ProgrammingGuide/tensorflow/">TFPark</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/text-models/">Text Models</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/bert-classifier/">BERT Classifier</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Feature Engineering</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../ProgrammingGuide/workingwithimages/">Working with Images</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/workingwithtexts/">Working with Texts</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Built-in Models</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../ProgrammingGuide/object-detection/">Object Detection API</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/image-classification/">Image Classification API</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/text-classification/">Text Classification API</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/recommendation/">Recommendation API</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/anomaly-detection/">Anomaly Detection API</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/text-matching/">Text Matching API</a>
</li>
            
<li >
    <a href="../../../ProgrammingGuide/seq2seq/">Sequence to Sequence API</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="../../../ProgrammingGuide/usercases-overview/">Reference Use Cases</a>
</li>
                                    
<li >
    <a href="../../../ProgrammingGuide/run-on-dataproc/">Run on Google Cloud Dataproc</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">White Paper <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../wp-bigdl/">BigDL</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">Pipeline APIs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../PipelineAPI/nnframes/">NNFrames</a>
</li>
            
<li >
    <a href="../../PipelineAPI/math/">Autograd-Math</a>
</li>
            
<li >
    <a href="../../PipelineAPI/variable/">Autograd-Variable</a>
</li>
            
<li >
    <a href="../../PipelineAPI/net/">Net</a>
</li>
            
<li >
    <a href="../../PipelineAPI/inference/">Inference</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">TFPark API</a>
    <ul class="dropdown-menu">
            
<li class="active">
    <a href="./">KerasModel</a>
</li>
            
<li >
    <a href="../estimator/">TFEstimator</a>
</li>
            
<li >
    <a href="../text-models/">Text Models</a>
</li>
            
<li >
    <a href="../bert-classifier/">BERT Classifier</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Feature Engineering</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../FeatureEngineering/featureset/">FeatureSet</a>
</li>
            
<li >
    <a href="../../FeatureEngineering/relation/">Relation</a>
</li>
            
<li >
    <a href="../../FeatureEngineering/image/">Image</a>
</li>
            
<li >
    <a href="../../FeatureEngineering/text/">Text</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Models</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../Models/object-detection/">Object Detection</a>
</li>
            
<li >
    <a href="../../Models/image-classification/">Image Classification</a>
</li>
            
<li >
    <a href="../../Models/text-classification/">Text Classification</a>
</li>
            
<li >
    <a href="../../Models/recommendation/">Recommendation</a>
</li>
            
<li >
    <a href="../../Models/anomaly-detection/">Anomaly Detection</a>
</li>
            
<li >
    <a href="../../Models/text-matching/">Text Matching</a>
</li>
            
<li >
    <a href="../../Models/seq2seq/">Sequence to Sequence</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Keras-Style API Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../KerasStyleAPIGuide/keras-api-python/">Python Guide</a>
</li>
                                    
<li >
    <a href="../../../KerasStyleAPIGuide/keras-api-scala/">Scala Guide</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Layers</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/activation/">Activation</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/initialization/">Initialization</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/core/">Core Layers</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/convolutional/">Convolutional Layers</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/pooling/">Pooling Layers</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/recurrent/">Recurrent Layers</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/normalization/">Normalization Layers</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/embedding/">Embedding Layers</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/dropout/">Dropout Layers</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/advanced-activation/">Advanced Activations</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Layers/wrappers/">Layer Wrappers</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Optimization</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../KerasStyleAPIGuide/Optimization/training/">Train, evaluate or predict a model</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Optimization/optimizers/">Optimizers</a>
</li>
            
<li >
    <a href="../../../KerasStyleAPIGuide/Optimization/objectives/">Objectives</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../../powered-by/">Powered by</a>
                            </li>
                            <li >
                                <a href="../../../presentations/">Presentations</a>
                            </li>
                            <li >
                                <a href="../../../known-issues/">FAQ and Known Issues</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../../PipelineAPI/inference/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../estimator/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/intel-analytics/analytics-zoo/edit/master/docs/APIGuide/TFPark/model.md">Edit on Fork on GitHub </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#methods">Methods</a></li>
            <li><a href="#9595init9595">__init__</a></li>
            <li><a href="#fit">fit</a></li>
            <li><a href="#evaluate">evaluate</a></li>
            <li><a href="#predict">predict</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>KerasModel enables user to use <code>tf.keras</code> API to define TensorFlow models and perform training or evaluation on top
of Spark and BigDL in a distributed fashion.</p>
<pre><code class="python">from zoo.tfpark import KerasModel, TFDataset
import tensorflow as tf

model = tf.keras.Sequential(
    [tf.keras.layers.Flatten(input_shape=(28, 28, 1)),
     tf.keras.layers.Dense(64, activation='relu'),
     tf.keras.layers.Dense(10, activation='softmax'),
     ]
)

model.compile(optimizer=tf.keras.optimizers.RMSprop(),
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])
keras_model = KerasModel(model)
</code></pre>

<h2 id="methods">Methods</h2>
<h3 id="9595init9595">__init__</h3>
<pre><code class="python">KerasModel(model)
</code></pre>

<h4 id="arguments">Arguments</h4>
<ul>
<li><strong>model</strong>: a compiled keras model defined using <code>tf.keras</code></li>
</ul>
<h3 id="fit">fit</h3>
<pre><code class="python">fit(x=None, y = None, batch_size=None, epochs=1, validation_split=0., validation_data=None, distributed=False)
</code></pre>

<h4 id="arguments_1">Arguments</h4>
<ul>
<li>
<p><strong>x</strong>: Input data. It could be:</p>
<pre><code> - a TFDataset object
 - A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).
 - A dict mapping input names to the corresponding array/tensors, if the model has named inputs.
</code></pre>
</li>
<li>
<p><strong>y</strong>: Target data. Like the input data <code>x</code>,
         It should be consistent with <code>x</code> (you cannot have Numpy inputs and
         tensor targets, or inversely). If <code>x</code> is a TFDataset, <code>y</code> should
         not be specified (since targets will be obtained from <code>x</code>).</p>
</li>
<li>
<p><strong>batch_size</strong>: Integer or <code>None</code>.
                  Number of samples per gradient update.
                  If <code>x</code> is a TFDataset, you do not need to specify batch_size.</p>
</li>
<li>
<p><strong>epochs</strong>: Integer. Number of epochs to train the model.
              An epoch is an iteration over the entire <code>x</code> and <code>y</code>
              data provided.</p>
</li>
<li>
<p><strong>validation_split</strong>: Float between 0 and 1.
                        Fraction of the training data to be used as validation data.
                        The model will set apart this fraction of the training data,
                        will not train on it, and will evaluate
                        the loss and any model metrics
                        on this data at the end of each epoch.</p>
</li>
<li>
<p><strong>validation_data</strong>: validation_data: Data on which to evaluate
                       the loss and any model metrics at the end of each epoch.
                       The model will not be trained on this data.
                       <code>validation_data</code> will override <code>validation_split</code>.
                       <code>validation_data</code> could be:</p>
<pre><code>                  - tuple `(x_val, y_val)` of Numpy arrays or tensors
                  - `TFDataset`
</code></pre>
<ul>
<li><strong>distributed</strong>: Boolean. Whether to do prediction in distributed mode or local mode.
               Default is True. In local mode, x must be a Numpy array.</li>
</ul>
</li>
</ul>
<h3 id="evaluate">evaluate</h3>
<pre><code class="python">evaluate(x=None, y=None, bath_per_thread=None, distributed=False)
</code></pre>

<h4 id="arguments_2">Arguments</h4>
<ul>
<li><strong>x</strong>: Input data. It could be:<pre><code>    - a TFDataset object
    - A Numpy array (or array-like), or a list of arrays
       (in case the model has multiple inputs).
    - A dict mapping input names to the corresponding array/tensors,
    if the model has named inputs.
</code></pre>
<ul>
<li><strong>y</strong>: Target data. Like the input data <code>x</code>,
     It should be consistent with <code>x</code> (you cannot have Numpy inputs and
     tensor targets, or inversely). If <code>x</code> is a TFDataset, <code>y</code> should
     not be specified (since targets will be obtained from <code>x</code>).</li>
<li><strong>batch_per_thread</strong>:
      The default value is 1.
      When distributed is True,the total batch size is batch_per_thread * rdd.getNumPartitions.
      When distributed is False the total batch size is batch_per_thread * numOfCores.</li>
<li><strong>distributed</strong>: Boolean. Whether to do prediction in distributed mode or local mode.
               Default is True. In local mode, x must be a Numpy array.</li>
</ul>
</li>
</ul>
<h3 id="predict">predict</h3>
<pre><code class="python">predict(x, batch_per_thread=None, distributed=False):
</code></pre>

<h4 id="arguments_3">Arguments</h4>
<ul>
<li><strong>x</strong>: Input data. It could be:<pre><code>    - a TFDataset object
    - A Numpy array (or array-like), or a list of arrays
       (in case the model has multiple inputs).
    - A dict mapping input names to the corresponding array/tensors,
</code></pre>
<ul>
<li><strong>batch_per_thread</strong>:
      The default value is 1.
      When distributed is True,the total batch size is batch_per_thread * rdd.getNumPartitions.
      When distributed is False the total batch size is batch_per_thread * numOfCores.</li>
<li><strong>distributed</strong>: Boolean. Whether to do prediction in distributed mode or local mode.
                Default is True. In local mode, x must be a Numpy array.</li>
</ul>
</li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
